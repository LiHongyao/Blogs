# # 与iOS 通信

**=> iOS To JS**

在window定义方法，将方法名给iOS那边调用即可。

**=> JS To iOS**

```markdown
# 1. 直接调用
window.webkit.messageHandlers.<方法名>.postMessage(<数据>) 
```

```markdown
# 2. 同步返回/发送数据给iOS,并同步获取iOS返回的数据

=> 「js: 通过 prompt 发送，将需要传送的数据以JSON对象形式作为prompt参数」
prompt(JSON.stringify({key:value, ...}))
```

```objective-c
=> 「iOS：拦截prompt」
// 设置代理
self.webView.UIDelegate = self;

// JS端调用prompt函数时，会触发此代理方法。
- (void)webView:(WKWebView *)webView runJavaScriptTextInputPanelWithPrompt:(NSString *)prompt defaultText:(nullable NSString *)defaultText initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(NSString * __nullable result))completionHandler {
    NSError *err = nil;
    NSData *dataFromString = [prompt dataUsingEncoding:NSUTF8StringEncoding];
    // 读取数据
    NSDictionary *data = [NSJSONSerialization JSONObjectWithData:dataFromString options:NSJSONReadingMutableContainers error:&err];
    if (!err){
        // 返回数据
        completionHandler(returnValue);
    }
}
```

# # 与Android通信

**=> Android To JS**

在window定义方法，将方法名给安卓那边调用即可。

**=> JS To Android**

安卓映射方法名调用/安卓那边绑定方法至window，js直接调用方法即可。

